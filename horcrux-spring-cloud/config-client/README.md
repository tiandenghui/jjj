# config-client
  业务微服务集成，用于从config server获取自己所需的配置文件信息。与config server关联信息请参照config-server的readme。

## 高可用情况下，配置客户端的使用  
  启动多个配置中心服务端，并将其注册到Eureka中心；
  更改客户端端口，启动不同客户端，并注册到Eureka中心；
  Eureka会将客户端请求分流到不同的配置中心服务端。
  注：在启动配置服务客户端前，先将对应的bootstrap-*文件改为bootstrap.yml。
 
## 高可用情况下，客户端本地配置问题  	

- 配置方式1
spring:
  cloud:
    config:
      profile: dev
      discovery: 
        enabled: true
        service-id: config-server  

  -- 使用这中服务发现discovery.service-id的方式,经测试资料查证，有如下问题：
  1）向注册中心注册服务的语句，必须写在本地，不支持语句放置到svn仓库上，这样注册语句放到本地的话，
    a、配置文件分散不好维护
    b、使用配置中心仓库存放微服务的配置文件里，基本就木有多少配置可以存放的了，这样的话，项目引入配置中心就木有多大用处了
    c、对于配置中心仓库里到底应该存些什么数据，本地配置文件应该存放哪些数据配置，也木有找到文章说明，所以
       本框架项目中暂时本地配置文件中只存放：
           spring.cloud.config、
           server.port、 
           spring.application.name、
           其他不支持放到远程仓库的配置语句(指如果本地木有，启动项目就会报错的，这个跟springcloud启动加载一些参数顺序有关吧)
       其余配置都放置到配置中心的远程仓库中的配置文件里。
       后期发现更好的方式，再斟酌是否需要变动吧。
                                               
  2）获取仓库配置文件是会从localhost获取，这样肯定是不对的，因为配置中心大可能是跟配置中心部署在不同服务上的，
     这样是获取不到库上的配置文件的。应该是从注册中心获取到配置中心，然后由那个配置中心下载。这个可能是配置中心的坑吧。
     暂时木有找到好的解决办法。

   -- 可以动态使用ribbon做负载均衡，自动切换可用的配置中心
        
- 配置方式2
spring:
  cloud:
    config:
      uri: ${config.server.uri.peer1}
      profile: dev
      
     缺点：
        写死了配置中心的地址，不能动态切换其他可用配置中心，其实木有真正自动化达到高可用目的
     优点：
        1）向注册中心注册服务的语句，支持语句放置到svn仓库上，配置文件便于维护。
        2）以后开发的业务微服务多了，可以分散到三个集群的配置中心，可以起到分流把。
           比如共有300个微服务，可以一个配置中心接入100个微服务，这样启动从仓库加载配置文件速度肯定会提高。

**** 整合上述比较，配置方式1的问题2不能解决，现在只能采用配置方式2。
     待后续找到更好解决方案优化
            
  